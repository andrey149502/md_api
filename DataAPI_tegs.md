# Управление тегами

**ДОСТУПНО КЛИЕНТАМ**

## Создание тега

Метод | create.tags
:---- | :------------
Версия API | v2
Описание | Создание тега
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Для агента является обязательным</blockquote>
name | string | да |  | Название тега

### Параметры ответа

Название | Тип | Обязательный | Допустимые значения | Описание
--- | --- | --- | --- | ---
id | number | да |  | Уникальный идентификатор тега

### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"create.tags",
  "params":{
    "access_token":"string",
    "user_id":"number",
    "name":"string"
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{
    "id":"number"
  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом create](#)"

## Редактирование тега

Метод | update.tags
:---- | :---------------
Версия API | v2
Описание | Редактирование тега
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
id | number | да |  | Уникальный идентификатор тега
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Является обязательным для агента</blockquote>
name | string | нет |  | Название тега

### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"update.tags",
  "params":{
    "access_token":"string",
    "id":"number",
    "user_id":"number",
    "name":"string"
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{

  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом update](#)"

## Удаление тега

Метод | delete.tags
:---- | :---------------
Версия API | v2
Описание | Удаление тега
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

> Нельзя удалять системные теги - "Продажа", "Нецелевой контакт", "Лид", "Генератор лидов"

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
id | number | да |  | Уникальный идентификатор тега
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Является обязательным для агента</blockquote>

### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"delete.tags",
  "params":{
    "access_token":"string",
    "id":"number",
    "user_id":"number"
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{

  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом delete](#)"


## Получение списка тегов

Метод | get.tags
:---- | :---------------
Версия API | v2
Описание | Получение списка тегов
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Является обязательным для агента</blockquote>
limit | number | нет |  | Количество возвращаемых записей.
offset | number | нет |  | Сдвиг, определяет с какого номера записи возвращать "limit" записей. По умолчанию "0".
filter | object | нет |  | См. раздел **"Критерии фильтрации"**
fields | array | нет |  | См. раздел **"Представление возвращаемых данных"**
sort | array | нет |  | См. раздел **"Сортировка данных"**

### Параметры ответа

Название | Тип  | Допустимые значения | Фильтрация | Сортировка | Описание
:------- | :--- | :-----------------: | :--------- | :--------- | :-------
id | number | | да | | Уникальный идентификатор тега
name | string | | да | да | Название тега
is_system | boolean | | | | Признак, того что тег системный и не может быть удален

### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"get.tags",
  "params":{
    "access_token":"string",
    "user_id":"number",
    "offset":"number",
    "limit":"number",
    "filter":{

    },
    "sort":[
      {
        "field":"string",
        "order":"string"
      }
    ],
    "fields":[
      "string"
    ]
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{
    "metadata":{

    },
    "data":[
      {
        "id":"number",
        "name":"string",
        "is_system":"boolean"
      }
    ]
  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом get](#)"


## Проставление тега продажа на обращение

Метод | set.tag_sales
:---- | :---------------
Версия API | v2
Описание | Проставление тега продажа на обращение
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

> Метод доступен для использования, если у сайта активна опция "Учитывать продажи" (см. метод "create.sites" и параметр "count_sales_enabled").

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Является обязательным для агента</blockquote>
communication_id | number | да |  | Уникальный идентификатор обращения. По данному идентификатору можно получить детализированную информацию используя следующие методы **"get.communications_report"**, **"get.chats_report "**, **"get.goals_report"**, **"get.offline_messages_report "**, **"get.calls_report"**
cummunication_type | enum | да | chat, call, goal, offline_message | Уникальный идентификатор обращения. По данному идентификатору можно получить детализированную информацию используя следующие методы **"get.communications_report"**, **"get.chats_report "**, **"get.goals_report"**, **"get.offline_messages_report "**, **"get.calls_report"**
date_time | iso8601 | да | YYYY-MM-DD hh:mm:ss | Дата и время сделки <blockquote>Не должна быть раньше даты обращения</blockquote>
transaction_value | number | да |  | Стоимость сделки
comment | string | нет | Максимальная длина 255 символов | Комментарий к сделке

### Параметры ответа

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
id | number | да |  | Уникальный идентификатор продажи. См. метод **"get.sales_report"**

### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"set.tag_sales",
  "params":{
    "access_token":"string",
    "user_id":"number",
    "communication_id":"number",
    "communication_type":"enum",
    "date_time":"iso8601",
    "transaction_value":"number",
    "comment":"string"
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{
    "id":"number"
  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом set](#)"


## Проставление тега на обращение

Метод | set.tag_communications
:---- | :---------------
Версия API | v2
Описание | Проставление тега на обращение
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Является обязательным для агента</blockquote>
communication_id | number | да |  | Уникальный идентификатор обращения. По данному идентификатору можно получить детализированную информацию используя следующие методы **"get.communications_report"**, **"get.chats_report "**, **"get.goals_report"**, **"get.offline_messages_report "**, **"get.calls_report"**
cummunication_type | enum | да | chat, call, goal, offline_message | 
tag_id | number | да |  | Уникальный идентификатор тега, см. метод **"get.tags"**

### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"set.tag_communications",
  "params":{
    "access_token":"string",
    "user_id":"number",
    "communication_id":"number",
    "communication_type":"enum",
    "tag_id":"number"
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{

  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом set](#)"


## Снятие тега с обращения

Метод | unset.tag_communications
:---- | :---------------
Версия API | v2
Описание | Снятие тега с обращения (так же используется для снятия тега продажа)
Кому доступен | Партнёр, Клиент
Ссылка | Вернуться к списку методов

> При снятии тега "Продажа" удаляется данные из таблицы analytics.sale

### Параметры запроса

Название | Тип  | Обязательный | Допустимые значения | Описание
:------- | :--- | :----------: | :------------------ | :-------
access_token | string | да |  | Ключ сессии аутентификации
user_id | number | нет |  | Уникальный идентификатор пользователя клиента агента от имени которого делается запрос <blockquote>Является обязательным для агента</blockquote>
communication_id | number | да |  | Уникальный идентификатор обращения. По данному идентификатору можно получить детализированную информацию используя следующие методы **"get.communications_report"**, **"get.chats_report "**, **"get.goals_report"**, **"get.offline_messages_report "**, **"get.calls_report"**
cummunication_type | enum | да | chat, call, goal, offline_message  | Уникальный идентификатор обращения. По данному идентификатору можно получить детализированную информацию используя следующие методы **"get.communications_report"**, **"get.chats_report "**, **"get.goals_report"**, **"get.offline_messages_report "**, **"get.calls_report"**
tag_id | number | да |  | Уникальный идентификатор тега, см. метод **"get.tags"**


### JSON структура запроса

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "method":"unset.tag_communications",
  "params":{
    "access_token":"string",
    "user_id":"number",
    "communication_id":"number",
    "communication_type":"enum",
    "tag_id":"number"
  }
}
```

### JSON структура ответа

```json
{
  "jsonrpc":"2.0",
  "id":"number",
  "result":{

  }
}
```

### Список возвращаемых ошибок

Смотрим раздел "[Список ошибок для методов с глаголом unset](#)"
